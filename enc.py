import base64

code = """
aW1wb3J0IG9zCmltcG9ydCB3ZWJicm93c2VyCmltcG9ydCBzdWJwcm9jZXNzCgojIOKchSBUT09M
IENPTkZJR1VSQVRJT04KVE9PTF9LRVkgPSAieCIKVEVMRUdSQU1fTElOSyA9ICJodHRwczovL3Qu
bWUvWVRfTVVSU0xFRU5fQ0hFQVRTX1ZJUCIKU1RPUkFHRV9QQVRIID0gIi9zdG9yYWdlL2VtdWxh
dGVkLzAvQFlUX01VUlNMRUVOIC5oIgpJTlBVVF9GT0xERVIgPSBvcy5wYXRoLmpvaW4oU1RPUkFH
RV9QQVRILCAiaW5wdXRfcG5ncyIpCk9VVFBVVF9GT0xERVIgPSBvcy5wYXRoLmpvaW4oU1RPUkFH
RV9QQVRILCAib3V0cHV0X2hlYWRlcnMiKQoKIyDinIUgQ09MT1IgQ09ORklHClJFRCA9ICJcMDMz
WzkxbSIKR1JFRU4gPSAiXDAzM1s5Mm0iCllFTExPVyA9ICJcMDMzWzkzbSIKQkxVRSA9ICJcMDMz
Wzk0bSIKQ1lBTiA9ICJcMDMzWzk2bSIKV0hJVEUgPSAiXDAzM1s5N20iCk1BR0VOVEEgPSAiXDAz
M1s5NW0iClJFU0VUID0gIlwwMzNbMG0iCgpkZWYgYmFubmVyKCk6CiAgICBvcy5zeXN0ZW0oImNs
ZWFyIikKICAgIHByaW50KGYie01BR0VOVEF9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PXtSRVNFVH0iKQogICAgcHJpbnQoZiIiIntSRUR9e0dSRUVOfXtZRUxMT1d9e0NZ
QU59e0JMVUV9e01BR0VOVEF9e1dISVRFfXtSRVNFVH0ge1lFTExPV31Ze1JFRH1Ue0JMVUV9LU17
R1JFRU59VVJTe1lFTExPV31MRUVOIHtDWUFOfVZJUCB7TUFHRU5UQX1UT09MIHtXSElURX0gUE5H
IHtSRUR9VE8ge0dSRUVOfS5Ie1JFU0VUfSIiIikKICAgIHByaW50KGYie01BR0VOVEF9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PXtSRVNFVH0iKQoKZGVmIG9wZW5fdGVs
ZWdyYW0oKToKICAgIHByaW50KGYiXG57QkxVRX3wn5OiIE9wZW5pbmcge0dSRUVOfVRlbGVncmFt
IHtSRUR9Q2hhbm5lbC4uLntSRVNFVH0iKQoKICAgIHRyeToKICAgICAgICBzdWJwcm9jZXNzLnJ1
bihbInRlcm11eC1vcGVuLXVybCIsIFRFTEVHUkFNX0xJTktdLCBjaGVjaz1UcnVlKQogICAgZXhj
ZXB0OgogICAgICAgIHdlYmJyb3dzZXIub3BlbihURUxFR1JBTV9MSU5LKQoKICAgIHByaW50KGYi
e0dSRUVOfeKchSBKb2luIEhlcmU6IHtURUxFR1JBTV9MSU5LfXtSRVNFVH1cbiIpCgpkZWYgY2hl
Y2tfa2V5KCk6CiAgICBwcmludChmIlxu8J+UkSB7Q1lBTn1FTlRFUiBUT09MIEtFWSBUTyBDT05U
SU5VRXtSRVNFVH0iKQogICAgdXNlcl9rZXkgPSBpbnB1dChmIntZRUxMT1d98J+UkCBFbnRlciBL
ZXk6IHtSRVNFVH0iKQoKICAgIGlmIHVzZXJfa2V5ID09IFRPT0xfS0VZOgogICAgICAgIHByaW50
KGYiXG7inIUge1JFRH1De0dSRUVOfW97WUVMTE9XfXJ7QkxVRX1ye01BR0VOVEF9ZXtXSElURX1j
e0NZQU59dCB7UkVEfUt7R1JFRU59ZXtZRUxMT1d9eXtSRVNFVH0hIHtHUkVFTn1Ub29sIFVubG9j
a2VkIPCfmoB7UkVTRVR9XG4iKQogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAg
IHByaW50KGYiXG7inYwge1JFRH1Xcm9uZyBLZXkhIHtZRUxMT1d9Sm9pbiB7QkxVRX1UZWxlZ3Jh
bSB7R1JFRU59Zm9yIHtNQUdFTlRBfUFjY2VzcyB7V0hJVEV98J+UkntSRVNFVH0iKQogICAgICAg
IG9wZW5fdGVsZWdyYW0oKQogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIHBuZ190b19oZWFkZXIo
cG5nX2ZpbGUsIGhlYWRlcl9maWxlKToKICAgIHRyeToKICAgICAgICB3aXRoIG9wZW4ocG5nX2Zp
bGUsICJyYiIpIGFzIGY6CiAgICAgICAgICAgIGRhdGEgPSBmLnJlYWQoKQoKICAgICAgICB3aXRo
IG9wZW4oaGVhZGVyX2ZpbGUsICJ3IikgYXMgZjoKICAgICAgICAgICAgZi53cml0ZSgiLypcbiIp
CiAgICAgICAgICAgIGYud3JpdGUoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIikK
ICAgICAgICAgICAgZi53cml0ZSgiQ1JFQVRFRC1CWSA6IFlULU1VUlNMRUVOIFRPT0xcbiIpCiAg
ICAgICAgICAgIGYud3JpdGUoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIikKICAg
ICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgZi53cml0ZSgi
TWFpbi5jcHAgY29kZXMg8J+Rh1xuXG4iKQogICAgICAgICAgICBmLndyaXRlKCI9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT1cbiIpCiAgICAgICAgICAgIGYud3JpdGUoIkxvZ29QaWMgPSBD
cmVhdGVUZXh0dXJlKExvZ29QaWNfZGF0YSwgc2l6ZW9mKExvZ29QaWNfZGF0YSkpO1xuXG4iKQog
ICAgICAgICAgICBmLndyaXRlKCIjaW5jbHVkZSBJTUFHRS9Mb2dvUGljLmhcblxuIikKICAgICAg
ICAgICAgZi53cml0ZSgiVGV4dHVyZUluZm8gTG9nb1BpYztcblxuIikKICAgICAgICAgICAgZi53
cml0ZSgiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4iKQogICAgICAgICAgICBmLndy
aXRlKCIqL1xuXG4iKQoKICAgICAgICAgIyAgIGYud3JpdGUoIiNpZm5kZWYgSU1BR0VfSFxuI2Rl
ZmluZSBJTUFHRV9IXG5cbiIpCiAgICAgICAgICAgIGYud3JpdGUoImNvbnN0IHVuc2lnbmVkIGNo
YXIgaW1hZ2VfZGF0YVtdID0ge1xuICAgICIpCgogICAgICAgICAgICBoZXhfZGF0YSA9ICcsICcu
am9pbihmIjB4e2J5dGU6MDJYfSIgZm9yIGJ5dGUgaW4gZGF0YSkKICAgICAgICAgICAgZi53cml0
ZShoZXhfZGF0YSkKCiAgICAgICAgICAgIGYud3JpdGUoIlxufTtcbi8vQ1JFQVRFRCBCWSA6IFlU
LU1VUlNMRUVOIikKCiAgICAgICAgcHJpbnQoZiJ7R1JFRU59W+KchSBTVUNDRVNTXSB7WUVMTE9X
fXtwbmdfZmlsZX0ge0JMVUV94oaSIHtSRUR9e2hlYWRlcl9maWxlfXtSRVNFVH0iKQoKICAgIGV4
Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIntSRUR9W+KdjCBFUlJPUl0ge3Bu
Z19maWxlfToge1dISVRFfXtlfXtSRVNFVH0iKQoKZGVmIGJhdGNoX2NvbnZlcnQoKToKICAgIGlm
IG5vdCBvcy5wYXRoLmV4aXN0cyhJTlBVVF9GT0xERVIpOgogICAgICAgIG9zLm1ha2VkaXJzKElO
UFVUX0ZPTERFUikKICAgICAgICBwcmludChmIntDWUFOffCfk4Ige1JFRH1Gb2xkZXIgQ3JlYXRl
ZDoge0dSRUVOfXtJTlBVVF9GT0xERVJ9IHtXSElURX0oQWRkIFBOR3MgSGVyZSl7UkVTRVR9IikK
CiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoT1VUUFVUX0ZPTERFUik6CiAgICAgICAgb3MubWFr
ZWRpcnMoT1VUUFVUX0ZPTERFUikKICAgICAgICBwcmludChmIntDWUFOffCfk4Ige01BR0VOVEF9
Rm9sZGVyIENyZWF0ZWQ6IHtHUkVFTn17T1VUUFVUX0ZPTERFUn0ge1dISVRFfShIZWFkZXJzIFdp
bGwgU2F2ZSBIZXJlKXtSRVNFVH0iKQoKICAgIHBuZ19maWxlcyA9IFtmIGZvciBmIGluIG9zLmxp
c3RkaXIoSU5QVVRfRk9MREVSKSBpZiBmLmVuZHN3aXRoKCIucG5nIildCgogICAgaWYgbm90IHBu
Z19maWxlczoKICAgICAgICBwcmludChmIntZRUxMT1d9W+KaoO+4j10ge1JFRH1ObyBQTkcgZmls
ZXMgZm91bmQhIHtHUkVFTn1BZGQgUE5HcyB0byB7TUFHRU5UQX0naW5wdXRfcG5ncyd7UkVTRVR9
IikKICAgICAgICByZXR1cm4KCiAgICBmb3IgcG5nIGluIHBuZ19maWxlczoKICAgICAgICBwbmdf
cGF0aCA9IG9zLnBhdGguam9pbihJTlBVVF9GT0xERVIsIHBuZykKICAgICAgICBoZWFkZXJfcGF0
aCA9IG9zLnBhdGguam9pbihPVVRQVVRfRk9MREVSLCBwbmcucmVwbGFjZSgiLnBuZyIsICIuaCIp
KQogICAgICAgIHBuZ190b19oZWFkZXIocG5nX3BhdGgsIGhlYWRlcl9wYXRoKQoKZGVmIG1haW5f
bWVudSgpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBiYW5uZXIoKQogICAgICAgIHByaW50KGYi
e0dSRUVOffCfjqgge0JMVUV9UE5HIHtNQUdFTlRBfVRPIHtZRUxMT1d9Lkgge1JFRH1DT05WRVJU
RVIgLSB7Q1lBTn1ZVC1NVVJTTEVFTiB7V0hJVEV9VklQIFRPT0x7UkVTRVR9IikKICAgICAgICBw
cmludChmIntSRUR9Me+4j+KDoyB7R1JFRU59Q29udmVydCB7WUVMTE9XfVBOR3Mge0JMVUV9dG8g
e01BR0VOVEF9Lmh7UkVTRVR9IikKICAgICAgICBwcmludChmIntDWUFOfTLvuI/ig6Mge01BR0VO
VEF9Sm9pbiB7V0hJVEV9VGVsZWdyYW0ge0dSRUVOfUNoYW5uZWx7UkVTRVR9IikKICAgICAgICBw
cmludChmIntSRUR9M++4j+KDoyB7WUVMTE9XfUV4aXR7UkVTRVR9IikKCiAgICAgICAgY2hvaWNl
ID0gaW5wdXQoZiJcbvCfkYkge1dISVRFfUNob29zZSB7QkxVRX1PcHRpb246IHtSRVNFVH0iKQoK
ICAgICAgICBpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICBiYXRjaF9jb252ZXJ0KCkKICAg
ICAgICBlbGlmIGNob2ljZSA9PSAiMiI6CiAgICAgICAgICAgIG9wZW5fdGVsZWdyYW0oKQogICAg
ICAgIGVsaWYgY2hvaWNlID09ICIzIjoKICAgICAgICAgICAgcHJpbnQoZiJcbvCfkYsge1JFRH1F
eGl0aW5nIHtZRUxMT1d9VG9vbC4uLntSRVNFVH0iKQogICAgICAgICAgICBicmVhawogICAgICAg
IGVsc2U6CiAgICAgICAgICAgIHByaW50KGYiXG7inYwge1JFRH1JbnZhbGlkIHtXSElURX1PcHRp
b24hIHtDWUFOfVRyeSB7R1JFRU59QWdhaW4ue1JFU0VUfSIpCgppZiBfX25hbWVfXyA9PSAiX19t
YWluX18iOgogICAgYmFubmVyKCkKICAgIGlmIGNoZWNrX2tleSgpOgogICAgICAgIG1haW5fbWVu
dSgp
"""

exec(base64.b64decode(code))
